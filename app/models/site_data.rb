class SiteData
  def self.get_api_result(url, path); process_response(get_api_response(url), path); end
  
  def self.get_api_results(url, spec)
    response = get_api_response(url)
    if response
      result = {}
      spec.each do |key, path|
        value = process_response(response, path)
        result[key] = value if value
      end
      result
    end
  end
  
  CANNED_RESPONSES = {
    'http://eol.org/api/hierarchy_entries/36071396.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"10000642", "taxonID"=>36071396, "parentNameUsageID"=>36065416, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"Fam.", "source"=>"http://eol.org/pages/5955/hierarchy_entries/36071396/overview", "nameAccordingTo"=>["Index Fungorum"], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"10000001", "taxonID"=>35694170, "parentNameUsageID"=>0, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"regn.", "source"=>"http://eol.org/pages/5559/hierarchy_entries/35694170/overview"}, {"sourceIdentifier"=>"10000006", "taxonID"=>35966747, "parentNameUsageID"=>35694170, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phyl.", "source"=>"http://eol.org/pages/5664/hierarchy_entries/35966747/overview"}, {"sourceIdentifier"=>"10000007", "taxonID"=>35966748, "parentNameUsageID"=>35966747, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"cl.", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/35966748/overview"}, {"sourceIdentifier"=>"10000123", "taxonID"=>36065416, "parentNameUsageID"=>35966748, "taxonConceptID"=>5674, "scientificName"=>"Boletales", "taxonRank"=>"ord.", "source"=>"http://eol.org/pages/5674/hierarchy_entries/36065416/overview"}], "children"=>[{"sourceIdentifier"=>"17194", "taxonID"=>36071397, "parentNameUsageID"=>36071396, "taxonConceptID"=>21561, "scientificName"=>"Brauniellula A.H. Sm. & Singer 1959", "taxonRank"=>"gen.", "source"=>"http://eol.org/pages/21561/hierarchy_entries/36071397/overview"}, {"sourceIdentifier"=>"17449", "taxonID"=>36071402, "parentNameUsageID"=>36071396, "taxonConceptID"=>21510, "scientificName"=>"Cystogomphus Singer, 1942", "taxonRank"=>"gen.", "source"=>"http://eol.org/pages/21510/hierarchy_entries/36071402/overview"}, {"sourceIdentifier"=>"17689", "taxonID"=>36071404, "parentNameUsageID"=>36071396, "taxonConceptID"=>18511188, "scientificName"=>"Gomphus (Fr.) Weinm. 1826", "taxonRank"=>"gen.", "source"=>"http://eol.org/pages/18511188/hierarchy_entries/36071404/overview"}, {"sourceIdentifier"=>"17299", "taxonID"=>36071405, "parentNameUsageID"=>36071396, "taxonConceptID"=>21877, "scientificName"=>"Chroogomphus (Singer) O.K. Mill. 1964", "taxonRank"=>"gen.", "source"=>"http://eol.org/pages/21877/hierarchy_entries/36071405/overview"}, {"sourceIdentifier"=>"17963", "taxonID"=>36071444, "parentNameUsageID"=>36071396, "taxonConceptID"=>6669332, "scientificName"=>"Leucogomphidius Kotl. & Pouzar 1972", "taxonRank"=>"gen.", "source"=>"http://eol.org/pages/6669332/hierarchy_entries/36071444/overview"}, {"sourceIdentifier"=>"17684", "taxonID"=>36071454, "parentNameUsageID"=>36071396, "taxonConceptID"=>16631, "scientificName"=>"Gomphidius Fr. 1836", "taxonRank"=>"gen.", "source"=>"http://eol.org/pages/16631/hierarchy_entries/36071454/overview"}, {"sourceIdentifier"=>"17685", "taxonID"=>36071536, "parentNameUsageID"=>36071396, "taxonConceptID"=>101152, "scientificName"=>"Gomphogaster O.K. Mill. 1973", "taxonRank"=>"gen.", "source"=>"http://eol.org/pages/101152/hierarchy_entries/36071536/overview"}]},
    'http://eol.org/api/hierarchy_entries/36071402.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"17449", "taxonID"=>36071402, "parentNameUsageID"=>36071396, "taxonConceptID"=>21510, "scientificName"=>"Cystogomphus Singer, 1942", "taxonRank"=>"Gen.", "source"=>"http://eol.org/pages/21510/hierarchy_entries/36071402/overview", "nameAccordingTo"=>["Index Fungorum"], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"10000001", "taxonID"=>35694170, "parentNameUsageID"=>0, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"regn.", "source"=>"http://eol.org/pages/5559/hierarchy_entries/35694170/overview"}, {"sourceIdentifier"=>"10000006", "taxonID"=>35966747, "parentNameUsageID"=>35694170, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phyl.", "source"=>"http://eol.org/pages/5664/hierarchy_entries/35966747/overview"}, {"sourceIdentifier"=>"10000007", "taxonID"=>35966748, "parentNameUsageID"=>35966747, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"cl.", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/35966748/overview"}, {"sourceIdentifier"=>"10000123", "taxonID"=>36065416, "parentNameUsageID"=>35966748, "taxonConceptID"=>5674, "scientificName"=>"Boletales", "taxonRank"=>"ord.", "source"=>"http://eol.org/pages/5674/hierarchy_entries/36065416/overview"}, {"sourceIdentifier"=>"10000642", "taxonID"=>36071396, "parentNameUsageID"=>36065416, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"fam.", "source"=>"http://eol.org/pages/5955/hierarchy_entries/36071396/overview"}], "children"=>[{"sourceIdentifier"=>"285955", "taxonID"=>36071403, "parentNameUsageID"=>36071402, "taxonConceptID"=>190465, "scientificName"=>"Cystogomphus humblotii Singer 1942", "taxonRank"=>"sp.", "source"=>"http://eol.org/pages/190465/hierarchy_entries/36071403/overview"}]},
    'http://eol.org/api/hierarchy_entries/36071403.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"285955", "taxonID"=>36071403, "parentNameUsageID"=>36071402, "taxonConceptID"=>190465, "scientificName"=>"Cystogomphus humblotii Singer 1942", "taxonRank"=>"Sp.", "source"=>"http://eol.org/pages/190465/hierarchy_entries/36071403/overview", "nameAccordingTo"=>["Index Fungorum"], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"10000001", "taxonID"=>35694170, "parentNameUsageID"=>0, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"regn.", "source"=>"http://eol.org/pages/5559/hierarchy_entries/35694170/overview"}, {"sourceIdentifier"=>"10000006", "taxonID"=>35966747, "parentNameUsageID"=>35694170, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phyl.", "source"=>"http://eol.org/pages/5664/hierarchy_entries/35966747/overview"}, {"sourceIdentifier"=>"10000007", "taxonID"=>35966748, "parentNameUsageID"=>35966747, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"cl.", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/35966748/overview"}, {"sourceIdentifier"=>"10000123", "taxonID"=>36065416, "parentNameUsageID"=>35966748, "taxonConceptID"=>5674, "scientificName"=>"Boletales", "taxonRank"=>"ord.", "source"=>"http://eol.org/pages/5674/hierarchy_entries/36065416/overview"}, {"sourceIdentifier"=>"10000642", "taxonID"=>36071396, "parentNameUsageID"=>36065416, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"fam.", "source"=>"http://eol.org/pages/5955/hierarchy_entries/36071396/overview"}, {"sourceIdentifier"=>"17449", "taxonID"=>36071402, "parentNameUsageID"=>36071396, "taxonConceptID"=>21510, "scientificName"=>"Cystogomphus Singer, 1942", "taxonRank"=>"gen.", "source"=>"http://eol.org/pages/21510/hierarchy_entries/36071402/overview"}], "children"=>[]},
    'http://eol.org/api/hierarchy_entries/36071415.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"483929", "taxonID"=>36071415, "parentNameUsageID"=>36071405, "taxonConceptID"=>6669307, "scientificName"=>"Chroogomphus asiaticus O. K. Mill. & Aime 2001", "taxonRank"=>"Sp.", "source"=>"http://eol.org/pages/6669307/hierarchy_entries/36071415/overview", "nameAccordingTo"=>["Index Fungorum"], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"10000001", "taxonID"=>35694170, "parentNameUsageID"=>0, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"regn.", "source"=>"http://eol.org/pages/5559/hierarchy_entries/35694170/overview"}, {"sourceIdentifier"=>"10000006", "taxonID"=>35966747, "parentNameUsageID"=>35694170, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phyl.", "source"=>"http://eol.org/pages/5664/hierarchy_entries/35966747/overview"}, {"sourceIdentifier"=>"10000007", "taxonID"=>35966748, "parentNameUsageID"=>35966747, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"cl.", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/35966748/overview"}, {"sourceIdentifier"=>"10000123", "taxonID"=>36065416, "parentNameUsageID"=>35966748, "taxonConceptID"=>5674, "scientificName"=>"Boletales", "taxonRank"=>"ord.", "source"=>"http://eol.org/pages/5674/hierarchy_entries/36065416/overview"}, {"sourceIdentifier"=>"10000642", "taxonID"=>36071396, "parentNameUsageID"=>36065416, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"fam.", "source"=>"http://eol.org/pages/5955/hierarchy_entries/36071396/overview"}, {"sourceIdentifier"=>"17299", "taxonID"=>36071405, "parentNameUsageID"=>36071396, "taxonConceptID"=>21877, "scientificName"=>"Chroogomphus (Singer) O.K. Mill. 1964", "taxonRank"=>"gen.", "source"=>"http://eol.org/pages/21877/hierarchy_entries/36071405/overview"}], "children"=>[]},
    'http://eol.org/api/hierarchy_entries/46608107.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"623905", "taxonID"=>46608107, "parentNameUsageID"=>46608104, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"Family", "source"=>"http://eol.org/pages/5955/hierarchy_entries/46608107/overview", "nameAccordingTo"=>["Integrated Taxonomic Information System (ITIS)"], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"555705", "taxonID"=>46604043, "parentNameUsageID"=>0, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"kingdom", "source"=>"http://eol.org/pages/5559/hierarchy_entries/46604043/overview"}, {"sourceIdentifier"=>"623881", "taxonID"=>46608047, "parentNameUsageID"=>46604043, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"division", "source"=>"http://eol.org/pages/5664/hierarchy_entries/46608047/overview"}, {"sourceIdentifier"=>"14093", "taxonID"=>46608048, "parentNameUsageID"=>46608047, "taxonConceptID"=>5665, "scientificName"=>"Basidiomycetes", "taxonRank"=>"class", "source"=>"http://eol.org/pages/5665/hierarchy_entries/46608048/overview"}, {"sourceIdentifier"=>"623889", "taxonID"=>46608104, "parentNameUsageID"=>46608048, "taxonConceptID"=>5674, "scientificName"=>"Boletales", "taxonRank"=>"order", "source"=>"http://eol.org/pages/5674/hierarchy_entries/46608104/overview"}], "children"=>[]},
    'http://eol.org/api/hierarchy_entries/51040676.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"5389", "taxonID"=>51040676, "parentNameUsageID"=>51040675, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"Family", "source"=>"http://eol.org/pages/5955/hierarchy_entries/51040676/overview", "nameAccordingTo"=>["NCBI Taxonomy"], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"131567", "taxonID"=>50799580, "parentNameUsageID"=>0, "taxonConceptID"=>6061725, "scientificName"=>"Cellular organisms", "source"=>"http://eol.org/pages/6061725/hierarchy_entries/50799580/overview"}, {"sourceIdentifier"=>"2759", "taxonID"=>50806972, "parentNameUsageID"=>50799580, "taxonConceptID"=>2908256, "scientificName"=>"Eukaryota", "taxonRank"=>"superkingdom", "source"=>"http://eol.org/pages/2908256/hierarchy_entries/50806972/overview"}, {"sourceIdentifier"=>"33154", "taxonID"=>50955056, "parentNameUsageID"=>50806972, "taxonConceptID"=>2910700, "scientificName"=>"Opisthokonta", "source"=>"http://eol.org/pages/2910700/hierarchy_entries/50955056/overview"}, {"sourceIdentifier"=>"4751", "taxonID"=>50955057, "parentNameUsageID"=>50955056, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"kingdom", "source"=>"http://eol.org/pages/5559/hierarchy_entries/50955057/overview"}, {"sourceIdentifier"=>"451864", "taxonID"=>50967166, "parentNameUsageID"=>50955057, "taxonConceptID"=>10594877, "scientificName"=>"Dikarya", "taxonRank"=>"subkingdom", "source"=>"http://eol.org/pages/10594877/hierarchy_entries/50967166/overview"}, {"sourceIdentifier"=>"5204", "taxonID"=>51020239, "parentNameUsageID"=>50967166, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phylum", "source"=>"http://eol.org/pages/5664/hierarchy_entries/51020239/overview"}, {"sourceIdentifier"=>"5302", "taxonID"=>51020240, "parentNameUsageID"=>51020239, "taxonConceptID"=>5665, "scientificName"=>"Agaricomycotina", "source"=>"http://eol.org/pages/5665/hierarchy_entries/51020240/overview"}, {"sourceIdentifier"=>"155619", "taxonID"=>51022567, "parentNameUsageID"=>51020240, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"class", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/51022567/overview"}, {"sourceIdentifier"=>"452333", "taxonID"=>51029858, "parentNameUsageID"=>51022567, "taxonConceptID"=>9133349, "scientificName"=>"Agaricomycetidae", "taxonRank"=>"subclass", "source"=>"http://eol.org/pages/9133349/hierarchy_entries/51029858/overview"}, {"sourceIdentifier"=>"68889", "taxonID"=>51039525, "parentNameUsageID"=>51029858, "taxonConceptID"=>5674, "scientificName"=>"Boletales", "taxonRank"=>"order", "source"=>"http://eol.org/pages/5674/hierarchy_entries/51039525/overview"}, {"sourceIdentifier"=>"227332", "taxonID"=>51040675, "parentNameUsageID"=>51039525, "taxonConceptID"=>11977342, "scientificName"=>"Suillineae", "taxonRank"=>"suborder", "source"=>"http://eol.org/pages/11977342/hierarchy_entries/51040675/overview"}], "children"=>[{"sourceIdentifier"=>"5390", "taxonID"=>51040677, "parentNameUsageID"=>51040676, "taxonConceptID"=>21877, "scientificName"=>"Chroogomphus", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/21877/hierarchy_entries/51040677/overview"}, {"sourceIdentifier"=>"5392", "taxonID"=>51040697, "parentNameUsageID"=>51040676, "taxonConceptID"=>16631, "scientificName"=>"Gomphidius", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/16631/hierarchy_entries/51040697/overview"}, {"sourceIdentifier"=>"80626", "taxonID"=>51040710, "parentNameUsageID"=>51040676, "taxonConceptID"=>21561, "scientificName"=>"Brauniellula", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/21561/hierarchy_entries/51040710/overview"}, {"sourceIdentifier"=>"451124", "taxonID"=>51040712, "parentNameUsageID"=>51040676, "taxonConceptID"=>11977376, "scientificName"=>"Environmental samples", "source"=>"http://eol.org/pages/11977376/hierarchy_entries/51040712/overview"}]},
    'http://eol.org/api/hierarchy_entries/51040687.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"134609", "taxonID"=>51040687, "parentNameUsageID"=>51040677, "taxonConceptID"=>6669307, "scientificName"=>"Chroogomphus asiaticus", "taxonRank"=>"Species", "source"=>"http://eol.org/pages/6669307/hierarchy_entries/51040687/overview", "nameAccordingTo"=>["NCBI Taxonomy"], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"131567", "taxonID"=>50799580, "parentNameUsageID"=>0, "taxonConceptID"=>6061725, "scientificName"=>"Cellular organisms", "source"=>"http://eol.org/pages/6061725/hierarchy_entries/50799580/overview"}, {"sourceIdentifier"=>"2759", "taxonID"=>50806972, "parentNameUsageID"=>50799580, "taxonConceptID"=>2908256, "scientificName"=>"Eukaryota", "taxonRank"=>"superkingdom", "source"=>"http://eol.org/pages/2908256/hierarchy_entries/50806972/overview"}, {"sourceIdentifier"=>"33154", "taxonID"=>50955056, "parentNameUsageID"=>50806972, "taxonConceptID"=>2910700, "scientificName"=>"Opisthokonta", "source"=>"http://eol.org/pages/2910700/hierarchy_entries/50955056/overview"}, {"sourceIdentifier"=>"4751", "taxonID"=>50955057, "parentNameUsageID"=>50955056, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"kingdom", "source"=>"http://eol.org/pages/5559/hierarchy_entries/50955057/overview"}, {"sourceIdentifier"=>"451864", "taxonID"=>50967166, "parentNameUsageID"=>50955057, "taxonConceptID"=>10594877, "scientificName"=>"Dikarya", "taxonRank"=>"subkingdom", "source"=>"http://eol.org/pages/10594877/hierarchy_entries/50967166/overview"}, {"sourceIdentifier"=>"5204", "taxonID"=>51020239, "parentNameUsageID"=>50967166, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phylum", "source"=>"http://eol.org/pages/5664/hierarchy_entries/51020239/overview"}, {"sourceIdentifier"=>"5302", "taxonID"=>51020240, "parentNameUsageID"=>51020239, "taxonConceptID"=>5665, "scientificName"=>"Agaricomycotina", "source"=>"http://eol.org/pages/5665/hierarchy_entries/51020240/overview"}, {"sourceIdentifier"=>"155619", "taxonID"=>51022567, "parentNameUsageID"=>51020240, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"class", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/51022567/overview"}, {"sourceIdentifier"=>"452333", "taxonID"=>51029858, "parentNameUsageID"=>51022567, "taxonConceptID"=>9133349, "scientificName"=>"Agaricomycetidae", "taxonRank"=>"subclass", "source"=>"http://eol.org/pages/9133349/hierarchy_entries/51029858/overview"}, {"sourceIdentifier"=>"68889", "taxonID"=>51039525, "parentNameUsageID"=>51029858, "taxonConceptID"=>5674, "scientificName"=>"Boletales", "taxonRank"=>"order", "source"=>"http://eol.org/pages/5674/hierarchy_entries/51039525/overview"}, {"sourceIdentifier"=>"227332", "taxonID"=>51040675, "parentNameUsageID"=>51039525, "taxonConceptID"=>11977342, "scientificName"=>"Suillineae", "taxonRank"=>"suborder", "source"=>"http://eol.org/pages/11977342/hierarchy_entries/51040675/overview"}, {"sourceIdentifier"=>"5389", "taxonID"=>51040676, "parentNameUsageID"=>51040675, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"family", "source"=>"http://eol.org/pages/5955/hierarchy_entries/51040676/overview"}, {"sourceIdentifier"=>"5390", "taxonID"=>51040677, "parentNameUsageID"=>51040676, "taxonConceptID"=>21877, "scientificName"=>"Chroogomphus", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/21877/hierarchy_entries/51040677/overview"}], "children"=>[]},
    'http://eol.org/api/hierarchy_entries/52783721.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"13024521", "taxonID"=>52783721, "parentNameUsageID"=>52783517, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"Family", "source"=>"http://eol.org/pages/5955/hierarchy_entries/52783721/overview", "nameAccordingTo"=>["Species 2000 & ITIS Catalogue of Life: April 2013"], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"13021511", "taxonID"=>52744048, "parentNameUsageID"=>0, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"kingdom", "source"=>"http://eol.org/pages/5559/hierarchy_entries/52744048/overview"}, {"sourceIdentifier"=>"13023981", "taxonID"=>52783235, "parentNameUsageID"=>52744048, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phylum", "source"=>"http://eol.org/pages/5664/hierarchy_entries/52783235/overview"}, {"sourceIdentifier"=>"13023986", "taxonID"=>52783516, "parentNameUsageID"=>52783235, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"class", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/52783516/overview"}, {"sourceIdentifier"=>"13023987", "taxonID"=>52783517, "parentNameUsageID"=>52783516, "taxonConceptID"=>11446982, "scientificName"=>"Boletales", "taxonRank"=>"order", "source"=>"http://eol.org/pages/11446982/hierarchy_entries/52783517/overview"}], "children"=>[{"sourceIdentifier"=>"13058801", "taxonID"=>52783722, "parentNameUsageID"=>52783721, "taxonConceptID"=>16631, "scientificName"=>"Gomphidius", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/16631/hierarchy_entries/52783722/overview"}, {"sourceIdentifier"=>"13058802", "taxonID"=>52783731, "parentNameUsageID"=>52783721, "taxonConceptID"=>21877, "scientificName"=>"Chroogomphus", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/21877/hierarchy_entries/52783731/overview"}, {"sourceIdentifier"=>"13062759", "taxonID"=>52783749, "parentNameUsageID"=>52783721, "taxonConceptID"=>21561, "scientificName"=>"Brauniellula", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/21561/hierarchy_entries/52783749/overview"}, {"sourceIdentifier"=>"13159416", "taxonID"=>52783753, "parentNameUsageID"=>52783721, "taxonConceptID"=>101152, "scientificName"=>"Gomphogaster", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/101152/hierarchy_entries/52783753/overview"}, {"sourceIdentifier"=>"13160257", "taxonID"=>52783755, "parentNameUsageID"=>52783721, "taxonConceptID"=>21510, "scientificName"=>"Cystogomphus", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/21510/hierarchy_entries/52783755/overview"}]},
    'http://eol.org/api/hierarchy_entries/52783747.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"8462886", "taxonID"=>52783747, "parentNameUsageID"=>52783731, "taxonConceptID"=>6669307, "scientificName"=>"Chroogomphus asiaticus O. K. Mill. & Aime 2001", "taxonRank"=>"Species", "source"=>"http://eol.org/pages/6669307/hierarchy_entries/52783747/overview", "nameAccordingTo"=>["Species 2000 & ITIS Catalogue of Life: April 2013", "Species Fungorum by Kirk P.M."], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"13021511", "taxonID"=>52744048, "parentNameUsageID"=>0, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"kingdom", "source"=>"http://eol.org/pages/5559/hierarchy_entries/52744048/overview"}, {"sourceIdentifier"=>"13023981", "taxonID"=>52783235, "parentNameUsageID"=>52744048, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phylum", "source"=>"http://eol.org/pages/5664/hierarchy_entries/52783235/overview"}, {"sourceIdentifier"=>"13023986", "taxonID"=>52783516, "parentNameUsageID"=>52783235, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"class", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/52783516/overview"}, {"sourceIdentifier"=>"13023987", "taxonID"=>52783517, "parentNameUsageID"=>52783516, "taxonConceptID"=>11446982, "scientificName"=>"Boletales", "taxonRank"=>"order", "source"=>"http://eol.org/pages/11446982/hierarchy_entries/52783517/overview"}, {"sourceIdentifier"=>"13024521", "taxonID"=>52783721, "parentNameUsageID"=>52783517, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"family", "source"=>"http://eol.org/pages/5955/hierarchy_entries/52783721/overview"}, {"sourceIdentifier"=>"13058802", "taxonID"=>52783731, "parentNameUsageID"=>52783721, "taxonConceptID"=>21877, "scientificName"=>"Chroogomphus", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/21877/hierarchy_entries/52783731/overview"}], "children"=>[]},
    'http://eol.org/api/hierarchy_entries/52783755.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"13160257", "taxonID"=>52783755, "parentNameUsageID"=>52783721, "taxonConceptID"=>21510, "scientificName"=>"Cystogomphus", "taxonRank"=>"Genus", "source"=>"http://eol.org/pages/21510/hierarchy_entries/52783755/overview", "nameAccordingTo"=>["Species 2000 & ITIS Catalogue of Life: April 2013"], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"13021511", "taxonID"=>52744048, "parentNameUsageID"=>0, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"kingdom", "source"=>"http://eol.org/pages/5559/hierarchy_entries/52744048/overview"}, {"sourceIdentifier"=>"13023981", "taxonID"=>52783235, "parentNameUsageID"=>52744048, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phylum", "source"=>"http://eol.org/pages/5664/hierarchy_entries/52783235/overview"}, {"sourceIdentifier"=>"13023986", "taxonID"=>52783516, "parentNameUsageID"=>52783235, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"class", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/52783516/overview"}, {"sourceIdentifier"=>"13023987", "taxonID"=>52783517, "parentNameUsageID"=>52783516, "taxonConceptID"=>11446982, "scientificName"=>"Boletales", "taxonRank"=>"order", "source"=>"http://eol.org/pages/11446982/hierarchy_entries/52783517/overview"}, {"sourceIdentifier"=>"13024521", "taxonID"=>52783721, "parentNameUsageID"=>52783517, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"family", "source"=>"http://eol.org/pages/5955/hierarchy_entries/52783721/overview"}], "children"=>[{"sourceIdentifier"=>"8446811", "taxonID"=>52783756, "parentNameUsageID"=>52783755, "taxonConceptID"=>190465, "scientificName"=>"Cystogomphus humblotii Singer 1942", "taxonRank"=>"species", "source"=>"http://eol.org/pages/190465/hierarchy_entries/52783756/overview"}]},
    'http://eol.org/api/hierarchy_entries/52783756.json?common_names=false&synonyms=false&cache_ttl=86400' => {"sourceIdentifier"=>"8446811", "taxonID"=>52783756, "parentNameUsageID"=>52783755, "taxonConceptID"=>190465, "scientificName"=>"Cystogomphus humblotii Singer 1942", "taxonRank"=>"Species", "source"=>"http://eol.org/pages/190465/hierarchy_entries/52783756/overview", "nameAccordingTo"=>["Species 2000 & ITIS Catalogue of Life: April 2013", "Species Fungorum by Kirk P.M."], "vernacularNames"=>[], "synonyms"=>[], "ancestors"=>[{"sourceIdentifier"=>"13021511", "taxonID"=>52744048, "parentNameUsageID"=>0, "taxonConceptID"=>5559, "scientificName"=>"Fungi", "taxonRank"=>"kingdom", "source"=>"http://eol.org/pages/5559/hierarchy_entries/52744048/overview"}, {"sourceIdentifier"=>"13023981", "taxonID"=>52783235, "parentNameUsageID"=>52744048, "taxonConceptID"=>5664, "scientificName"=>"Basidiomycota", "taxonRank"=>"phylum", "source"=>"http://eol.org/pages/5664/hierarchy_entries/52783235/overview"}, {"sourceIdentifier"=>"13023986", "taxonID"=>52783516, "parentNameUsageID"=>52783235, "taxonConceptID"=>2865511, "scientificName"=>"Agaricomycetes", "taxonRank"=>"class", "source"=>"http://eol.org/pages/2865511/hierarchy_entries/52783516/overview"}, {"sourceIdentifier"=>"13023987", "taxonID"=>52783517, "parentNameUsageID"=>52783516, "taxonConceptID"=>11446982, "scientificName"=>"Boletales", "taxonRank"=>"order", "source"=>"http://eol.org/pages/11446982/hierarchy_entries/52783517/overview"}, {"sourceIdentifier"=>"13024521", "taxonID"=>52783721, "parentNameUsageID"=>52783517, "taxonConceptID"=>5955, "scientificName"=>"Gomphidiaceae", "taxonRank"=>"family", "source"=>"http://eol.org/pages/5955/hierarchy_entries/52783721/overview"}, {"sourceIdentifier"=>"13160257", "taxonID"=>52783755, "parentNameUsageID"=>52783721, "taxonConceptID"=>21510, "scientificName"=>"Cystogomphus", "taxonRank"=>"genus", "source"=>"http://eol.org/pages/21510/hierarchy_entries/52783755/overview"}], "children"=>[]},
    'http://eol.org/api/pages/0.json?images=0&videos=0&sounds=0&maps=0&text=0&iucn=false&details=false&common_names=false&synonyms=false&references=false&cache_ttl=86400' => [{"error"=>"Unknown page id \"0\""}],
    'http://eol.org/api/pages/190465.json?images=0&videos=0&sounds=0&maps=0&text=0&iucn=false&details=false&common_names=false&synonyms=false&references=false&cache_ttl=86400' => {"identifier"=>190465, "scientificName"=>"Cystogomphus humblotii Singer 1942", "richness_score"=>5.48392, "synonyms"=>[], "vernacularNames"=>[], "references"=>[], "taxonConcepts"=>[{"identifier"=>52783756, "scientificName"=>"Cystogomphus humblotii Singer 1942", "nameAccordingTo"=>"Species 2000 & ITIS Catalogue of Life: April 2013", "canonicalForm"=>"Cystogomphus humblotii", "sourceIdentfier"=>"8446811", "taxonRank"=>"Species"}, {"identifier"=>43128106, "scientificName"=>"Cystogomphus humblotii Singer 1942", "nameAccordingTo"=>"GBIF Nub Taxonomy", "canonicalForm"=>"Cystogomphus humblotii", "sourceIdentfier"=>"2524953", "taxonRank"=>"Species"}, {"identifier"=>36071403, "scientificName"=>"Cystogomphus humblotii Singer 1942", "nameAccordingTo"=>"Index Fungorum", "canonicalForm"=>"Cystogomphus humblotii", "sourceIdentfier"=>"285955", "taxonRank"=>"Sp."}], "dataObjects"=>[]},
    'http://eol.org/api/pages/21510.json?images=0&videos=0&sounds=0&maps=0&text=0&iucn=false&details=false&common_names=false&synonyms=false&references=false&cache_ttl=86400' => {"identifier"=>21510, "scientificName"=>"Cystogomphus", "richness_score"=>12.5031, "synonyms"=>[], "vernacularNames"=>[], "references"=>[], "taxonConcepts"=>[{"identifier"=>52783755, "scientificName"=>"Cystogomphus", "nameAccordingTo"=>"Species 2000 & ITIS Catalogue of Life: April 2013", "canonicalForm"=>"Cystogomphus", "sourceIdentfier"=>"13160257", "taxonRank"=>"Genus"}, {"identifier"=>43128105, "scientificName"=>"Cystogomphus Singer", "nameAccordingTo"=>"GBIF Nub Taxonomy", "canonicalForm"=>"Cystogomphus", "sourceIdentfier"=>"2524952", "taxonRank"=>"Genus"}, {"identifier"=>36071402, "scientificName"=>"Cystogomphus Singer, 1942", "nameAccordingTo"=>"Index Fungorum", "canonicalForm"=>"Cystogomphus", "sourceIdentfier"=>"17449", "taxonRank"=>"Gen."}], "dataObjects"=>[]},
    'http://eol.org/api/pages/5955.json?images=0&videos=0&sounds=0&maps=0&text=0&iucn=false&details=false&common_names=false&synonyms=false&references=false&cache_ttl=86400' => {"identifier"=>5955, "scientificName"=>"Gomphidiaceae", "richness_score"=>46.5448, "synonyms"=>[], "vernacularNames"=>[], "references"=>[], "taxonConcepts"=>[{"identifier"=>52783721, "scientificName"=>"Gomphidiaceae", "nameAccordingTo"=>"Species 2000 & ITIS Catalogue of Life: April 2013", "canonicalForm"=>"Gomphidiaceae", "sourceIdentfier"=>"13024521", "taxonRank"=>"Family"}, {"identifier"=>46608107, "scientificName"=>"Gomphidiaceae", "nameAccordingTo"=>"Integrated Taxonomic Information System (ITIS)", "canonicalForm"=>"Gomphidiaceae", "sourceIdentfier"=>"623905", "taxonRank"=>"Family"}, {"identifier"=>43128104, "scientificName"=>"Gomphidiaceae Maire ex Jülich", "nameAccordingTo"=>"GBIF Nub Taxonomy", "canonicalForm"=>"Gomphidiaceae", "sourceIdentfier"=>"4192", "taxonRank"=>"Family"}, {"identifier"=>51040676, "scientificName"=>"Gomphidiaceae", "nameAccordingTo"=>"NCBI Taxonomy", "canonicalForm"=>"Gomphidiaceae", "sourceIdentfier"=>"5389", "taxonRank"=>"Family"}, {"identifier"=>36071396, "scientificName"=>"Gomphidiaceae", "nameAccordingTo"=>"Index Fungorum", "canonicalForm"=>"Gomphidiaceae", "sourceIdentfier"=>"10000642", "taxonRank"=>"Fam."}], "dataObjects"=>[]},
    'http://eol.org/api/pages/6669307.json?images=0&videos=0&sounds=0&maps=0&text=0&iucn=false&details=false&common_names=false&synonyms=false&references=false&cache_ttl=86400' => {"identifier"=>6669307, "scientificName"=>"Chroogomphus asiaticus O. K. Mill. & Aime 2001", "richness_score"=>6.77632, "synonyms"=>[], "vernacularNames"=>[], "references"=>[], "taxonConcepts"=>[{"identifier"=>52783747, "scientificName"=>"Chroogomphus asiaticus O. K. Mill. & Aime 2001", "nameAccordingTo"=>"Species 2000 & ITIS Catalogue of Life: April 2013", "canonicalForm"=>"Chroogomphus asiaticus", "sourceIdentfier"=>"8462886", "taxonRank"=>"Species"}, {"identifier"=>51040687, "scientificName"=>"Chroogomphus asiaticus", "nameAccordingTo"=>"NCBI Taxonomy", "canonicalForm"=>"Chroogomphus asiaticus", "sourceIdentfier"=>"134609", "taxonRank"=>"Species"}, {"identifier"=>43132114, "scientificName"=>"Chroogomphus asiaticus O. K. Mill. & Aime 2001", "nameAccordingTo"=>"GBIF Nub Taxonomy", "canonicalForm"=>"Chroogomphus asiaticus", "sourceIdentfier"=>"2524985", "taxonRank"=>"Species"}, {"identifier"=>36071415, "scientificName"=>"Chroogomphus asiaticus O. K. Mill. & Aime 2001", "nameAccordingTo"=>"Index Fungorum", "canonicalForm"=>"Chroogomphus asiaticus", "sourceIdentfier"=>"483929", "taxonRank"=>"Sp."}], "dataObjects"=>[]},
    'http://eol.org/api/search/Chroogomphus%20asiaticus.json?exact=1&cache_ttl=86400' => {"totalResults"=>1, "startIndex"=>1, "itemsPerPage"=>30, "results"=>[{"id"=>6669307, "title"=>"Chroogomphus asiaticus O. K. Mill. & Aime 2001", "link"=>"http://eol.org/6669307?action=overview&controller=taxa", "content"=>"Chroogomphus asiaticus O. K. Mill. & Aime 2001; Chroogomphus asiaticus"}], "first"=>"http://eol.org/api/search/Chroogomphus%20asiaticus.json?page=1", "self"=>"http://eol.org/api/search/Chroogomphus%20asiaticus.json?page=1", "last"=>"http://eol.org/api/search/Chroogomphus%20asiaticus.json?page=1"},
    'http://eol.org/api/search/Cystogomphus.json?exact=1&cache_ttl=86400' => {"totalResults"=>1, "startIndex"=>1, "itemsPerPage"=>30, "results"=>[{"id"=>21510, "title"=>"Cystogomphus", "link"=>"http://eol.org/21510?action=overview&controller=taxa", "content"=>"Cystogomphus; Cystogomphus Singer, 1942; Cystogomphus Singer (1942)"}], "first"=>"http://eol.org/api/search/Cystogomphus.json?page=1", "self"=>"http://eol.org/api/search/Cystogomphus.json?page=1", "last"=>"http://eol.org/api/search/Cystogomphus.json?page=1"},
    'http://eol.org/api/search/Gomphidiaceae.json?exact=1&cache_ttl=86400' => {"totalResults"=>1, "startIndex"=>1, "itemsPerPage"=>30, "results"=>[{"id"=>5955, "title"=>"Gomphidiaceae", "link"=>"http://eol.org/5955?action=overview&controller=taxa", "content"=>"Gomphidiaceae; Gomphidiaceae Maire ex Jülich"}], "first"=>"http://eol.org/api/search/Gomphidiaceae.json?page=1", "self"=>"http://eol.org/api/search/Gomphidiaceae.json?page=1", "last"=>"http://eol.org/api/search/Gomphidiaceae.json?page=1"},
    'http://eol.org/api/search/Gomphidiaceae.json?exact=t1' => {"totalResults"=>1, "startIndex"=>1, "itemsPerPage"=>30, "results"=>[{"id"=>5955, "title"=>"Gomphidiaceae", "link"=>"http://eol.org/5955?action=overview&controller=taxa", "content"=>"Gomphidiaceae; Gomphidiaceae Maire ex Jülich"}], "first"=>"http://eol.org/api/search/Gomphidiaceae.json?page=1", "self"=>"http://eol.org/api/search/Gomphidiaceae.json?page=1", "last"=>"http://eol.org/api/search/Gomphidiaceae.json?page=1"},
    'http://eol.org/api/search/My%20Name.json?exact=1&cache_ttl=86400' => {"totalResults"=>0, "startIndex"=>1, "itemsPerPage"=>30, "results"=>[]},
  }
  
  def self.get_api_response(url, ignore_testing=false)
    begin
      if Rails.env.test? and !ignore_testing
        CANNED_RESPONSES.member?(url) ? CANNED_RESPONSES[url] : get_with_print(url)
      else
        HTTParty.get(url)
      end
    rescue SocketError
      nil
    end
  end
  
  def self.get_with_print(url)
    result = HTTParty.get(url)
    # print "'#{url}' => #{result},\n" 
    result
  end
  
  def self.process_response(response, keys)
    if response.class == Array
      results = Set.new
      response.each {|r|
        s = process_response(r, keys)
        results += s unless s.nil?
      }
      results.length == 0 ? nil : results
    elsif keys == []
      response ? Set.new([response]) : nil
    elsif response.respond_to?(:keys)
      key = keys[0]
      if key.class == Array
        Set.new([key.map {|k| response[k]}])
      else
        process_response(response[key], keys[1..-1])
      end
    end
  end
  
  def self.log(str)
    Rails.logger.debug(str)
    str
  end
end
